# vim:ft=nginx:ts=4:sw=0:noet
server {
	listen 80;
	listen [::]:80;
	server_name {{ schedule_url }};
	root /var/www/schedule/www/public;

	location / {
		try_files $uri /index.php$is_args$args;
	}
	location ~* \.php($|/) {
		fastcgi_split_path_info ^(.+\.php)(/.*)$;
		fastcgi_index           index.php;
		fastcgi_pass            {{ docker_schedule_ip.stdout }}:9000;
		include                 fastcgi.conf;
		fastcgi_param           DOCUMENT_ROOT   /var/www/public;
		fastcgi_param           SCRIPT_FILENAME /var/www/public$fastcgi_script_name;
		fastcgi_param           SCRIPT_NAME     $fastcgi_script_name;
		fastcgi_param           PATH_INFO       $fastcgi_path_info;
	}
}
